// =============================================================================
// Auto-Generated Tauri Bindings
// =============================================================================
// This file simulates the auto-generated TypeScript bindings that Tauri
// generates from Rust types using tauri-specta or similar tools.
//
// DO NOT EDIT THIS FILE MANUALLY - it would be overwritten by the generator.
// =============================================================================

import { z } from "zod";
import {
  procedure,
  router,
  extractSubscriptionPaths,
  type SchemaContractToContract,
} from "@tauri-nexus/rpc-core";

// =============================================================================
// Zod Schemas (Generated from Rust structs via zod-rs-cli)
// =============================================================================

// Re-export all schemas from the generated schemas file
export {
  UserSchema,
  type User,
  GetUserInputSchema,
  type GetUserInput,
  CreateUserInputSchema,
  type CreateUserInput,
  UpdateUserInputSchema,
  type UpdateUserInput,
  DeleteUserInputSchema,
  type DeleteUserInput,
  GreetInputSchema,
  type GreetInput,
  HealthResponseSchema,
  type HealthResponse,
  CounterInputSchema,
  type CounterInput,
  CounterEventSchema,
  type CounterEvent,
  ChatRoomInputSchema,
  type ChatRoomInput,
  ChatMessageSchema,
  type ChatMessage,
  SendMessageInputSchema,
  type SendMessageInput,
  StockInputSchema,
  type StockInput,
  StockPriceSchema,
  type StockPrice,
} from "./schemas";

// Import schemas for use in contract definition
import {
  UserSchema,
  CreateUserInputSchema,
  UpdateUserInputSchema,
  HealthResponseSchema,
  CounterInputSchema,
  CounterEventSchema,
  ChatRoomInputSchema,
  ChatMessageSchema,
  SendMessageInputSchema,
  StockInputSchema,
  StockPriceSchema,
} from "./schemas";

// =============================================================================
// Additional Schemas (Not in Rust types)
// =============================================================================

/** Success response schema */
export const SuccessResponseSchema = z.object({
  success: z.boolean(),
  message: z.string().optional(),
});
export type SuccessResponse = z.infer<typeof SuccessResponseSchema>;

/** Chat history input schema */
export const ChatHistoryInputSchema = z.object({
  roomId: z.string(),
  limit: z.number().optional(),
});
export type ChatHistoryInput = z.infer<typeof ChatHistoryInputSchema>;

// =============================================================================
// RPC Contract Schema (Generated from Rust router definition)
// =============================================================================

/**
 * Application RPC Contract Schema - Generated from Rust router macros.
 * Uses Zod schemas for runtime validation and type inference.
 */
export const appContractSchema = router({
  health: procedure().output(HealthResponseSchema).query(),
  greet: procedure()
    .input(z.object({ name: z.string() }))
    .output(z.string())
    .query(),

  user: router({
    get: procedure()
      .input(z.object({ id: z.number() }))
      .output(UserSchema)
      .query(),
    list: procedure().output(z.array(UserSchema)).query(),
    create: procedure()
      .input(CreateUserInputSchema)
      .output(UserSchema)
      .mutation(),
    update: procedure()
      .input(UpdateUserInputSchema)
      .output(UserSchema)
      .mutation(),
    delete: procedure()
      .input(z.object({ id: z.number() }))
      .output(SuccessResponseSchema)
      .mutation(),
  }),

  stream: router({
    counter: procedure()
      .input(CounterInputSchema)
      .output(CounterEventSchema)
      .subscription(),
    stocks: procedure()
      .input(StockInputSchema)
      .output(StockPriceSchema)
      .subscription(),
    chat: procedure()
      .input(ChatRoomInputSchema)
      .output(ChatMessageSchema)
      .subscription(),
    time: procedure().output(z.string()).subscription(),
  }),

  chat: router({
    send: procedure()
      .input(SendMessageInputSchema)
      .output(ChatMessageSchema)
      .mutation(),
    history: procedure()
      .input(ChatHistoryInputSchema)
      .output(z.array(ChatMessageSchema))
      .query(),
  }),
});

/** Inferred contract type from schema */
export type AppContract = SchemaContractToContract<typeof appContractSchema>;

// =============================================================================
// Dynamic Subscription Path Extraction
// =============================================================================

/** Dynamically extracted subscription paths from the contract schema */
export const SUBSCRIPTION_PATHS = extractSubscriptionPaths(
  appContractSchema,
) as readonly string[];

// =============================================================================
// Event Types (Generated from Tauri events)
// =============================================================================

export type EventPayload<T> = {
  payload: T;
};

export const Events = {
  COUNTER_TICK: "counter:tick",
  STOCK_UPDATE: "stock:update",
  CHAT_MESSAGE: "chat:message",
  TIME_UPDATE: "time:update",
} as const;

export type EventName = (typeof Events)[keyof typeof Events];
